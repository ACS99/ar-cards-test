<html>
  <head>
    <meta charset="utf-8" />
    <title>AR Room with Marker</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.min.js"></script>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <!-- Tap-to-start button for sound -->
    <button id="startButton" style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px 40px;
      font-size: 18px;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 10px;
      z-index: 999;">
      Start AR
    </button>

    <a-scene
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
      renderer="logarithmicDepthBuffer: true;"
      device-orientation-permission-ui="enabled: true"
    >
      <!-- Load assets -->
      <a-assets>
        <a-asset-item id="room" src="models/test-tarjetas-ar1.glb"></a-asset-item>
        <audio id="birds" src="audio/bird.mp3"></audio>
      </a-assets>

      <!-- Lighting -->
      <a-entity light="type: ambient; color: #ffffff; intensity: 1"></a-entity>
      <a-entity light="type: directional; color: #ffffff; intensity: 0.6" position="1 1 0"></a-entity>

      <!-- AR Marker (Hiro) with room model attached -->
      <a-marker type="pattern" url="markers/pattern-marker.patt">
        <a-box position="0 0.5 0" color="red"></a-box>
        <a-entity gltf-model="#room"
            position="0 0 0"
            scale="0.05 0.05 0.05">
        </a-entity>
        <!-- Sound attached to marker -->
        <a-sound id="sound"
                 src="#birds"
                 autoplay="false"
                 loop="true"
                 positional="false"
                 volume="1">
        </a-sound>
      </a-marker>

      <!-- Camera (no need for wasd-controls with marker) -->
      <a-entity camera></a-entity>
    </a-scene>

    <!-- JS to start sound on tap -->
    <script>
      document.getElementById('startButton').addEventListener('click', function () {
        const soundEl = document.querySelector('#sound');
        if (soundEl && soundEl.components && soundEl.components.sound) {
          soundEl.components.sound.playSound();
        }
        this.style.display = 'none';
      });
    </script>
  </body>
</html>
